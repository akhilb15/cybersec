from pwn import *

conn = remote("chal.sigpwny.com", 1985)
p = 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919

while True:
    conn.recvline()
    out = conn.recvline()
    print(out)
    conn.unrecv(out)

    conn.recvuntil(b'b = ')
    b = int(conn.recvuntil(b'\n', True).decode('utf-8'))
    conn.recvuntil(b'A = ')
    A = int(conn.recvuntil(b'\n', True).decode('utf-8'))
    
    secret = pow(A,b,p)
    conn.sendline(str(secret).encode())
    

